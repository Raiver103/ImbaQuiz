import{l as G,u as I,r as t,j as e,m as L}from"./index-DvokuiYA.js";const P=()=>{const{quizId:g}=G(),{getAccessTokenSilently:v}=I(),[n,k]=t.useState([]),[o,q]=t.useState(0),[i,f]=t.useState(null),[a,m]=t.useState(!1),[y,S]=t.useState(0),[T,u]=t.useState(10),[x,b]=t.useState(!1),[j,p]=t.useState(!1),[N,C]=t.useState(!0),[d,z]=t.useState(null),h=t.useRef(null),c=t.useRef(!1);t.useEffect(()=>{(async()=>{try{C(!0);const r=await L(g,v);k(r),z(null)}catch(r){console.error("Error fetching questions:",r),z("Failed to load questions. Please try again later.")}finally{C(!1)}})()},[g,v]);const l=()=>{h.current&&(clearInterval(h.current),h.current=null)},Q=()=>{c.current||(c.current=!0,l(),o<n.length-1?(q(s=>s+1),f(null),m(!1),u(10)):b(!0),setTimeout(()=>{c.current=!1},0))},E=()=>{l(),u(10),h.current=setInterval(()=>{u(s=>s<=1?(Q(),0):s-1)},1e3)},R=s=>{!a&&!c.current&&(l(),f(s),s.isCorrect&&S(r=>r+1),m(!0),setTimeout(Q,2e3))};t.useEffect(()=>(j&&!x&&!a&&n.length>0&&E(),()=>l()),[j,x,a,o,n.length]);const A=()=>{l(),c.current=!1,q(0),f(null),m(!1),S(0),u(10),b(!1),p(!1)};if(!j)return e.jsxs("div",{className:"quiz-container",children:[e.jsx("h2",{children:"Quiz Game"}),d?e.jsxs("div",{className:"error-message",children:[e.jsx("p",{children:d}),e.jsx("button",{onClick:()=>window.location.reload(),children:"Retry"})]}):e.jsx("button",{className:"start-button",onClick:()=>p(!0),disabled:N,children:N?"Loading...":"Start Quiz"})]});if(x)return e.jsxs("div",{className:"quiz-container",children:[e.jsx("h2",{children:"Game Over!"}),e.jsxs("p",{className:"score-text",children:["Your score: ",e.jsx("span",{className:"score-value",children:y})," out of ",e.jsx("span",{className:"total-questions",children:n.length})]}),e.jsx("button",{className:"restart-button",onClick:A,children:"Play Again"})]});if(N)return e.jsxs("div",{className:"quiz-container",children:[e.jsx("h2",{children:"Loading questions..."}),e.jsx("div",{className:"loading-spinner"})]});if(d)return e.jsxs("div",{className:"quiz-container",children:[e.jsx("h2",{children:"Error"}),e.jsx("p",{className:"error-message",children:d}),e.jsx("button",{onClick:()=>window.location.reload(),children:"Retry"})]});if(n.length===0)return e.jsxs("div",{className:"quiz-container",children:[e.jsx("h2",{children:"No questions available"}),e.jsx("p",{children:"This quiz doesn't have any questions yet."})]});const w=n[o];return e.jsxs("div",{className:"quiz-container",children:[e.jsxs("div",{className:"quiz-header",children:[e.jsxs("h2",{children:["Question ",o+1," of ",n.length]}),e.jsxs("div",{className:"timer",children:["⏱️ ",T," sec"]})]}),e.jsxs("div",{className:"question-card",children:[e.jsx("h3",{className:"question-text",children:w.text}),e.jsx("div",{className:"answers-container",children:w.answers.map(s=>{let r="answer-button";return a&&(s.isCorrect?r+=" correct-answer":(i==null?void 0:i.id)===s.id&&!s.isCorrect&&(r+=" wrong-answer")),e.jsx("button",{className:r,onClick:()=>R(s),disabled:a||c.current,children:s.text},s.id)})})]}),a&&e.jsx("div",{className:"feedback",children:i!=null&&i.isCorrect?e.jsx("p",{className:"correct-feedback",children:"Correct! ✅"}):e.jsx("p",{className:"wrong-feedback",children:"Wrong! ❌"})})]})};export{P as default};
